---
IMPORTANT: This file was generated using src/processorgen/main.go. DO NOT EDIT.

title: 'cohere.rerank'
sidebar_position: 7
---

import ReactDiffViewer from 'react-diff-viewer';
import Chip from '@mui/material/Chip';
import Box from "@mui/system/Box";
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# `cohere.rerank`

Conduit processor for Cohere's rerank model.

## Description

Conduit processor for Cohere's rerank model.

## Configuration parameters

<Tabs groupId="config-params">
  <TabItem value="yaml" label="YAML">
```yaml
version: 2.2
pipelines:
  - id: example
    status: running
    connectors:
      # define source and destination ...
    processors:
      - id: example
        plugin: "cohere.rerank"
        settings:
          # APIKey is the API key for Cohere api calls.
          # Type: string
          apiKey: ""
          # Maximum number of retries for an individual record when backing off
          # following an error.
          # Type: float
          backoffRetry.count: "0"
          # The multiplying factor for each increment step.
          # Type: float
          backoffRetry.factor: "2"
          # The maximum waiting time before retrying.
          # Type: duration
          backoffRetry.max: "5s"
          # The minimum waiting time before retrying.
          # Type: duration
          backoffRetry.min: "100ms"
          # Model is one of the name of a compatible rerank model version.
          # Type: string
          model: "rerank-v3.5"
          # Query is the search query.
          # Type: string
          query: ""
          # RequestBodyRef specifies the api request field.
          # Type: string
          request.body: ".Payload.After"
          # ResponseBodyRef specifies in which field should the response body be
          # saved.
          # Type: string
          response.body: ".Payload.After"
          # Whether to decode the record key using its corresponding schema from
          # the schema registry.
          # Type: bool
          sdk.schema.decode.key.enabled: "true"
          # Whether to decode the record payload using its corresponding schema
          # from the schema registry.
          # Type: bool
          sdk.schema.decode.payload.enabled: "true"
          # Whether to encode the record key using its corresponding schema from
          # the schema registry.
          # Type: bool
          sdk.schema.encode.key.enabled: "true"
          # Whether to encode the record payload using its corresponding schema
          # from the schema registry.
          # Type: bool
          sdk.schema.encode.payload.enabled: "true"
```
  </TabItem>
  <TabItem value="table" label="Table">
  <table class="no-margin-table">
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
      <tr>
        <td>`apiKey`</td>
        <td>string</td>
        <td><Chip label="null" /></td>
        <td>
  APIKey is the API key for Cohere api calls.
        </td>
      </tr>
      <tr>
        <td>`backoffRetry.count`</td>
        <td>float</td>
        <td>`0`</td>
        <td>
  Maximum number of retries for an individual record when backing off following an error.
        </td>
      </tr>
      <tr>
        <td>`backoffRetry.factor`</td>
        <td>float</td>
        <td>`2`</td>
        <td>
  The multiplying factor for each increment step.
        </td>
      </tr>
      <tr>
        <td>`backoffRetry.max`</td>
        <td>duration</td>
        <td>`5s`</td>
        <td>
  The maximum waiting time before retrying.
        </td>
      </tr>
      <tr>
        <td>`backoffRetry.min`</td>
        <td>duration</td>
        <td>`100ms`</td>
        <td>
  The minimum waiting time before retrying.
        </td>
      </tr>
      <tr>
        <td>`model`</td>
        <td>string</td>
        <td>`rerank-v3.5`</td>
        <td>
  Model is one of the name of a compatible rerank model version.
        </td>
      </tr>
      <tr>
        <td>`query`</td>
        <td>string</td>
        <td><Chip label="null" /></td>
        <td>
  Query is the search query.
        </td>
      </tr>
      <tr>
        <td>`request.body`</td>
        <td>string</td>
        <td>`.Payload.After`</td>
        <td>
  RequestBodyRef specifies the api request field.
        </td>
      </tr>
      <tr>
        <td>`response.body`</td>
        <td>string</td>
        <td>`.Payload.After`</td>
        <td>
  ResponseBodyRef specifies in which field should the response body be saved.
        </td>
      </tr>
      <tr>
        <td>`sdk.schema.decode.key.enabled`</td>
        <td>bool</td>
        <td>`true`</td>
        <td>
  Whether to decode the record key using its corresponding schema from the schema registry.
        </td>
      </tr>
      <tr>
        <td>`sdk.schema.decode.payload.enabled`</td>
        <td>bool</td>
        <td>`true`</td>
        <td>
  Whether to decode the record payload using its corresponding schema from the schema registry.
        </td>
      </tr>
      <tr>
        <td>`sdk.schema.encode.key.enabled`</td>
        <td>bool</td>
        <td>`true`</td>
        <td>
  Whether to encode the record key using its corresponding schema from the schema registry.
        </td>
      </tr>
      <tr>
        <td>`sdk.schema.encode.payload.enabled`</td>
        <td>bool</td>
        <td>`true`</td>
        <td>
  Whether to encode the record payload using its corresponding schema from the schema registry.
        </td>
      </tr>
    </table>
  </TabItem>
</Tabs>

## Examples

### Generate responses using Cohere's rerank model


This example demonstrates how to use the Cohere rerank processor.This takes in a query and a list of texts and produces an ordered 
array with each text assigned a relevance score. The processor extracts text from the configured "request.body" (default: ".Payload.After"), 
sends it to the Cohere API, and stores the response in the configured "response.body".

In this example, the processor is configured with a mock client and an API key. The input record's metadata is updated
to include the rerank model used ("rerank-v3.5").

#### Configuration parameters

<Tabs groupId="config-params">
  <TabItem value="yaml" label="YAML">
```yaml
version: 2.2
pipelines:
  - id: example
    status: running
    connectors:
      # define source and destination ...
    processors:
      - id: example
        plugin: "cohere.rerank"
        settings:
          apiKey: "fakeapiKey"
          backoffRetry.count: "0"
          backoffRetry.factor: "2"
          backoffRetry.max: "5s"
          backoffRetry.min: "100ms"
          model: "rerank-v3.5"
          query: "What is the capital of the United States?"
          request.body: ".Payload.After"
          response.body: ".Payload.After"
```
  </TabItem>
  <TabItem value="table" label="Table">
  <table class="no-margin-table">
      <tr>
        <th>Name</th>
        <th>Value</th>
      </tr>
      <tr>
        <td>`apiKey`</td>
        <td>`fakeapiKey`</td>
      </tr>
      <tr>
        <td>`backoffRetry.count`</td>
        <td>`0`</td>
      </tr>
      <tr>
        <td>`backoffRetry.factor`</td>
        <td>`2`</td>
      </tr>
      <tr>
        <td>`backoffRetry.max`</td>
        <td>`5s`</td>
      </tr>
      <tr>
        <td>`backoffRetry.min`</td>
        <td>`100ms`</td>
      </tr>
      <tr>
        <td>`model`</td>
        <td>`rerank-v3.5`</td>
      </tr>
      <tr>
        <td>`query`</td>
        <td>`What is the capital of the United States?`</td>
      </tr>
      <tr>
        <td>`request.body`</td>
        <td>`.Payload.After`</td>
      </tr>
      <tr>
        <td>`response.body`</td>
        <td>`.Payload.After`</td>
      </tr>
    </table>
  </TabItem>
</Tabs>

#### Record difference

```mdx-code-block
<Box className='diff-viewer'>
  <ReactDiffViewer
    styles={{
      diffContainer: {
        overflowX: 'auto',
        overflowY: 'hidden',
      },
    }}
    leftTitle={'Before'}
    rightTitle={'After'}
    oldValue={"{\n  \"position\": \"cG9zLTE=\",\n  \"operation\": \"update\",\n  \"metadata\": null,\n  \"key\": null,\n  \"payload\": {\n    \"before\": null,\n    \"after\": \"Carson City is the capital city of the American state of Nevada.\"\n  }\n}"}
    newValue={"{\n  \"position\": \"cG9zLTE=\",\n  \"operation\": \"update\",\n  \"metadata\": null,\n  \"key\": null,\n  \"payload\": {\n    \"before\": null,\n    \"after\": \"{\\\"document\\\":{\\\"text\\\":\\\"Carson City is the capital city of the American state of Nevada.\\\"},\\\"index\\\":0,\\\"relevance_score\\\":0.9}\"\n  }\n}"}
    hideLineNumbers={false}
    showDiffOnly={false}
    splitView={true}
  />
</Box>
```



![scarf pixel conduit-site-docs-using-processors](https://static.scarf.sh/a.png?x-pxid=02ff4382-6501-4410-b523-fa8e7f879b00)